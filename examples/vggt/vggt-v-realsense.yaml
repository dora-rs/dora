nodes:
  - id: camera-0
    build: pip install -e ../../node-hub/dora-pyrealsense
    path: dora-pyrealsense
    inputs:
      tick: dora/timer/millis/300
    outputs:
      - image
      - depth
    env:
      DEVICE_SERIAL: "243222073837"

  - id: camera-1
    build: pip install -e ../../node-hub/dora-pyrealsense
    path: dora-pyrealsense
    inputs:
      tick: dora/timer/millis/300
    outputs:
      - image
      - depth
    env:
      DEVICE_SERIAL: "243322073274"

  - id: dora-vggt
    build: pip install -e ../../node-hub/dora-vggt
    path: dora-vggt
    inputs:
      image-0: camera-0/image
      image-1: camera-1/image
    outputs:
      - depth-0
      - image-0
      - depth-1
      - image-1
    env:
      CAMERA_HEIGHT_Y: 0.505
      DEPTH_ENCODING: mono16

  - id: rav1e-depth
    path: dora-rav1e
    build: cargo build -p dora-rav1e --release
    inputs:
      depth-0: dora-vggt/depth-0
    outputs:
      - depth-0
    env:
      ENCODING: avif

  - id: rav1e-image
    path: dora-rav1e
    build: cargo build -p dora-rav1e --release
    inputs:
      image-0: dora-vggt/image-0
    outputs:
      - image-0
    env:
      ENCODING: avif

  - id: camera-0-rav1e-image
    path: dora-rav1e
    build: cargo build -p dora-rav1e --release
    inputs:
      image: camera-0/image
    outputs:
      - image
    env:
      ENCODING: avif

  - id: camera-0-rav1e-depth
    path: dora-rav1e
    build: cargo build -p dora-rav1e --release
    inputs:
      depth: camera-0/depth
    outputs:
      - depth
    env:
      ENCODING: avif

  - id: plot
    build: pip install dora-rerun
    path: dora-rerun
    inputs:
      vggt-0/image-0: dora-vggt/image-0
      vggt-0/depth-0: dora-vggt/depth-0
      realsense-0/image: camera-0/image
      realsense-0/depth: camera-0/depth
      vggt-1/image-1: dora-vggt/image-1
      vggt-1/depth-1: dora-vggt/depth-1
      realsense-1/image: camera-1/image
      realsense-1/depth: camera-1/depth

  - id: bench
    path: image_saver.py
    inputs:
      vggt_image: rav1e-image/image-0
      vggt_depth: rav1e-depth/depth-0
      camera_image: camera-0-rav1e-image/image
      camera_depth: camera-0-rav1e-depth/depth
