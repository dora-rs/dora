communication:
  zenoh:
    prefix: /foo

nodes:
  - id: timer
    custom:
      run: cargo run --release --example example_source_timer
      outputs:
        - time

  - id: rate-limited-timer
    custom:
      run: cargo run --release --example rate_limit -- --seconds 0.5
      inputs:
        data: timer/time
      outputs:
        - rate_limited

  - id: random
    custom:
      run: cargo run --release --example random_number
      inputs:
        timestamp: rate-limited-timer/rate_limited
      outputs:
        - number

  - id: logger
    custom:
      run: cargo run --release --example example_sink_logger
      inputs:
        random: random/number
        time: timer/time
        timestamped-random: runtime-node/op-1/timestamped-random
        c-counter: runtime-node/op-2/counter
        python-counter: runtime-node/op-3/counter

  - id: runtime-node
    operators:
      - id: op-1
        shared-library: ../target/release/libexample_operator.so
        inputs:
          random: random/number
          time: timer/time
        outputs:
          - timestamped-random
      - id: op-2
        shared-library: ../runtime/examples/c-operator/operator.so
        inputs:
          time: timer/time
        outputs:
          - counter
      - id: op-3
        python: ../runtime/examples/python-operator/op.py
        inputs:
          time: timer/time
          test: python-operator/counter
        outputs:
          - counter

  - id: python-operator
    operator:
      python: ../runtime/examples/python-operator/op.py
      inputs:
        time: timer/time
      outputs:
        - counter
